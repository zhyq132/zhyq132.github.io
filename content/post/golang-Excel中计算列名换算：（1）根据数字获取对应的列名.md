---
title: "golang-Excel中计算列名换算：（1）根据数字获取对应的列名"
date: 2017-11-06T19:16:10+08:00
tags: ["golang"]
author: "七哥"
categories: ["Golang"]
---

## 需求描述
> 最近处理保养项目的需求，有需要导入导出大量的文件，从而获取不同的车款对应不同的项目的价格。。。在excel每一行中，从左往右写入数据时，往往需要定位位置，例如往A1中写入：姓名。B1中写入：马云。A2中写入：植物。B2中写入：阿里巴巴总裁。。

## 思路
> 乍一看感觉是类似26进制的算法，那就用类似进制转换的方式去处理。把A-Z分别是1-26，那么27就代表AA，703就代表AAA，以此类推。


## 先看代码
```
package main

import (
	fmt
)

func main() {
	x := 702
	y := 28
	z := 704

	var str string
	str = GetLetterByNum(x)
	fmt.Println(str)
	str = GetLetterByNum(y)
	fmt.Println(str)
	str = GetLetterByNum(z)
	fmt.Println(str)
	
	//上述代码打印结果为：
	//ZZ
	//AB
	//AAB
}

//GetLetterByNum 根据数字获取字符
func GetLetterByNum(num int) (s string) {
	if num <= 0 {
		panic(num参数取值范围为大于零的整数)
	}

	var temp []rune

	yu := 0
	shang := num
	for {
		yu = shang % 26
		shang = shang / 26

		if yu == 0 {
			yu = 26
			shang--
		}

		temp = append(temp, rune(yu+A-1))

		if shang == 0 {
			break
		}
	}

	for i := len(temp) - 1; i = 0; i-- {
		s += string(temp[i])
	}

	return
}

```


## 十进制转换为二进制
```
先写商，再写余，无余数写零。
2|  53     1
 |——————
2|  26     0
 |——————
2|  13     1
 |——————
2|  6      0
 |——————
2|  3      1
 |——————
2|  1      1
 |——————
    0
 //逆向取余数，即为：110101，所以十进制53专为成二进制就是110101
```


## 用进制转换的思路去处理26进制
```
26|  704     2
  |——————
26|  27      1
  |——————
26|  1       1
  |——————
     0       
 
 //逆向取余数，即为：112，所以十进制704专为成26进制就是112，对影成字符就变成了AAB
```
 
 

## 思考一下
- 当输入28 704的时候，上述算法都没问题。。。那么试下输入702、26的时候，会出现什么情况？
```
26|  26     0
  |——————
26|  1      1
  |——————
     0       
 
 
 逆向取余数，即为：A0（10），所以A0是什么鬼，发生了什么事情？？？
```

- 这个时候，我们就要调整一下流程了，加入一个规则：如果余数为0，那么从商中-1，还回一个‘26’到余数中，那么就是这样
```
26|  26     0
  |——————
     1 
 
这个时候余数是0，按照上述规则

26|  26     26
  |——————
     0 
 
 逆向取余数，即为：Z
```

## 最后，试着算一下702吧朋友



